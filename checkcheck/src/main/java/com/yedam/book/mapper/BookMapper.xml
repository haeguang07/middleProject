<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yedam.book.mapper.BookMapper">
<!-- private int isbn;
	private String bookName;
	private int bookPrice;
	private String author;
	private String publisher;
	private String bookCategory;
	private String bookDetail;
	private int bookCount;//판매량
	private int hitCount;//조회수
	private int bookStock;
	private String cover; -->
	<insert id="addbook" parameterType="book">
		insert into books values (#{isbn},#{bookName},#{bookPrice},#{author},#{publisher},#{bookCategory},#{bookDetail},#{bookCount},#{hitCount},#{bookStock},#{cover},#{pubDate})
	</insert>
	<select id="searchbook" resultType="book">
		select book_name, author, publisher, book_price, cover
		from books where book_category LIKE #{bookCategory}
	</select>
	<select id="categoryBookList" resultType="book">
		<![CDATA[
		select b.* 
		from(select rownum rn, a.*
			from (select * from books where book_category LIKE #{bookCategory}||'%'
				order by 1 desc) a
			where rownum <= #{page}*10) b
		where b.rn > (#{page} - 1)*10
		]]>
	</select>
	<select id="searchBookList" resultType="book">
		<![CDATA[
		select b.* 
		from(select rownum rn, a.*
			from (select * from books where book_category LIKE #{bookCategory}||'%'
				and book_name like '%'||#{search}||'%' order by 1 desc) a
			where rownum <= #{page}*10) b
		where b.rn > (#{page} - 1)*10
		]]>
	</select>
	<select id="getpageCount" resultType="int">
		select count(*) from books where book_category LIKE #{bookCategory}||'%'
	</select>
	<select id="getSearchPageCount" resultType="int">
		select count(*) from books where book_category LIKE #{bookCategory}||'%' and book_name like '%'||#{search}||'%'
	</select>
	<select id="mainRecommand" parameterType="String" resultType="book">
	<![CDATA[
		select rownum,a.*
		from (select * 
		from books
		where book_category like #{string}
		and book_name not like '%CD%'
		order by hitcount desc) a
		where rownum <6
		]]>
	</select>
	<select id="newList" resultType="book">
	<![CDATA[
		select rownum,a.* from books a
		where rownum < 9
		and book_name not like '%CD%'
		order by hitcount desc
		]]>
	</select>
</mapper>